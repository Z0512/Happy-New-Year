<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>新年快乐 </title>
<style>
html,body{
  margin:0;
  padding:0;
  background: radial-gradient(circle at bottom,#020111,#000);
  overflow:hidden;
  height:100%;
  font-family:"Microsoft YaHei",sans-serif;
}

canvas{
  position:fixed;
  left:0;
  top:0;
}

.title{
  position:fixed;
  top:18%;
  width:100%;
  text-align:center;
  font-size:40px;
  color:#fff;
  text-shadow:
    0 0 10px #ff0,
    0 0 20px #f00,
    0 0 40px #ff0;
  animation: glow 2s infinite alternate;
}

.subtitle{
  position:fixed;
  top:28%;
  width:100%;
  text-align:center;
  font-size:18px;
  color:#ddd;
  opacity:.8;
}

@keyframes glow{
  from{opacity:.6}
  to{opacity:1}
}

.bless{
  position:fixed;
  bottom:20%;
  width:100%;
  text-align:center;
  color:#ffd;
  font-size:16px;
  opacity:0;
  animation: fade 6s infinite;
}

@keyframes fade{
  0%{opacity:0}
  20%{opacity:1}
  80%{opacity:1}
  100%{opacity:0}
}
</style>
</head>

<body>
<canvas id="canvas"></canvas>

<div class="title"> 新年快乐 </div>
<div class="subtitle">点屏幕任意位置放烟花</div>
<div class="bless" id="bless">愿新的一年，万事胜意</div>

<script>
const canvas = document.getElementById("canvas");
const ctx = canvas.getContext("2d");
resize();

window.addEventListener("resize", resize);

function resize(){
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
}

let fireworks=[];

class Firework{
  constructor(x,y){
    this.x=x;
    this.y=y;
    this.particles=[];
    for(let i=0;i<80;i++){
      this.particles.push({
        x,
        y,
        angle:Math.random()*Math.PI*2,
        speed:Math.random()*6+2,
        alpha:1,
        color:`hsl(${Math.random()*360},100%,60%)`
      });
    }
  }
  update(){
    this.particles.forEach(p=>{
      p.x+=Math.cos(p.angle)*p.speed;
      p.y+=Math.sin(p.angle)*p.speed;
      p.speed*=0.96;
      p.alpha-=0.015;
    });
  }
  draw(){
    this.particles.forEach(p=>{
      if(p.alpha>0){
        ctx.globalAlpha=p.alpha;
        ctx.fillStyle=p.color;
        ctx.beginPath();
        ctx.arc(p.x,p.y,2,0,Math.PI*2);
        ctx.fill();
      }
    });
  }
}

function loop(){
  ctx.globalAlpha=0.2;
  ctx.fillStyle="#000";
  ctx.fillRect(0,0,canvas.width,canvas.height);
  ctx.globalAlpha=1;

  fireworks.forEach((f,i)=>{
    f.update();
    f.draw();
    if(f.particles.every(p=>p.alpha<=0)){
      fireworks.splice(i,1);
    }
  });
  requestAnimationFrame(loop);
}

canvas.addEventListener("touchstart",e=>{
  const t=e.touches[0];
  fireworks.push(new Firework(t.clientX,t.clientY));
});

canvas.addEventListener("click",e=>{
  fireworks.push(new Firework(e.clientX,e.clientY));
});

setInterval(()=>{
  fireworks.push(new Firework(
    Math.random()*canvas.width,
    Math.random()*canvas.height*0.5
  ));
},1200);

loop();
</script>
</body>
</html>
